<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aayush Agrawal">
<meta name="dcterms.date" content="2026-01-31">

<title>Using AI to Read Technical Research Papers ‚Äì Aayush Agrawal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8fedceaa9c5b51e05daa085a98af5997.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-af8a908a13f4fda948c7407926ad6c39.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-8fedceaa9c5b51e05daa085a98af5997.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7QN8N70N41"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-7QN8N70N41', { 'anonymize_ip': true});
</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Using AI to Read Technical Research Papers ‚Äì Aayush Agrawal">
<meta property="og:description" content="Aayush‚Äôs personal website">
<meta property="og:image" content="https://aayushmnit.com/posts/2026-01-31_ReadWithAI/paper_reading_ai.jpg">
<meta property="og:site_name" content="Aayush Agrawal">
<meta name="twitter:title" content="Using AI to Read Technical Research Papers ‚Äì Aayush Agrawal">
<meta name="twitter:description" content="Aayush‚Äôs personal website">
<meta name="twitter:image" content="https://aayushmnit.com/posts/2026-01-31_ReadWithAI/paper_reading_ai.jpg">
<meta name="twitter:creator" content="@aayushmnit">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Aayush Agrawal</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> <i class="bi bi-newspaper" role="img">
</i> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> <i class="bi bi-file-person" role="img">
</i> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-other" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-stack" role="img">
</i> 
 <span class="menu-text">Other</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-other">    
        <li>
    <a class="dropdown-item" href="https://aayushmnit.com/pytorch_book/"><i class="bi bi-box-arrow-up-right" role="img">
</i> 
 <span class="dropdown-text">Pytorch Book</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../other/carlson.html"><i class="bi bi-box-arrow-up-right" role="img">
</i> 
 <span class="dropdown-text">Carlson Q&amp;A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../talks.html"><i class="bi bi-megaphone" role="img">
</i> 
 <span class="dropdown-text">Talks</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://medium.com/@aayushmnit"> <i class="bi bi-bell" role="img">
</i> 
<span class="menu-text">Subscribe</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/aayushmnit/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/aayushmnit/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://medium.com/@aayushmnit"> <i class="bi bi-medium" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/aayushmnit"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:aayushmnit@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-i-started-using-ai-to-read-research-papers" id="toc-why-i-started-using-ai-to-read-research-papers" class="nav-link active" data-scroll-target="#why-i-started-using-ai-to-read-research-papers">Why I Started Using AI to Read Research Papers</a></li>
  <li><a href="#prerequisites-setup" id="toc-prerequisites-setup" class="nav-link" data-scroll-target="#prerequisites-setup">Prerequisites &amp; Setup</a>
  <ul class="collapse">
  <li><a href="#installing-ollama" id="toc-installing-ollama" class="nav-link" data-scroll-target="#installing-ollama">Installing Ollama</a></li>
  <li><a href="#choosing-and-pulling-a-model" id="toc-choosing-and-pulling-a-model" class="nav-link" data-scroll-target="#choosing-and-pulling-a-model">Choosing and Pulling a Model</a></li>
  <li><a href="#python-libraries" id="toc-python-libraries" class="nav-link" data-scroll-target="#python-libraries">Python Libraries</a></li>
  </ul></li>
  <li><a href="#core-workflow-pdf-to-conversation" id="toc-core-workflow-pdf-to-conversation" class="nav-link" data-scroll-target="#core-workflow-pdf-to-conversation">Core Workflow: PDF to Conversation</a>
  <ul class="collapse">
  <li><a href="#converting-pdf-to-markdown" id="toc-converting-pdf-to-markdown" class="nav-link" data-scroll-target="#converting-pdf-to-markdown">Converting PDF to Markdown</a></li>
  <li><a href="#designing-your-system-prompt" id="toc-designing-your-system-prompt" class="nav-link" data-scroll-target="#designing-your-system-prompt">Designing Your System Prompt</a></li>
  </ul></li>
  <li><a href="#wiring-up-the-conversation-with-lisette" id="toc-wiring-up-the-conversation-with-lisette" class="nav-link" data-scroll-target="#wiring-up-the-conversation-with-lisette">Wiring Up the Conversation with Lisette</a>
  <ul class="collapse">
  <li><a href="#live-example-reading-a-dpp-paper" id="toc-live-example-reading-a-dpp-paper" class="nav-link" data-scroll-target="#live-example-reading-a-dpp-paper">Live Example: Reading a DPP Paper</a></li>
  </ul></li>
  <li><a href="#managing-chat-history-checkpoints-and-context-control" id="toc-managing-chat-history-checkpoints-and-context-control" class="nav-link" data-scroll-target="#managing-chat-history-checkpoints-and-context-control">Managing Chat History: Checkpoints and Context Control</a>
  <ul class="collapse">
  <li><a href="#accessing-the-history" id="toc-accessing-the-history" class="nav-link" data-scroll-target="#accessing-the-history">Accessing the History</a></li>
  <li><a href="#creating-checkpoints" id="toc-creating-checkpoints" class="nav-link" data-scroll-target="#creating-checkpoints">Creating Checkpoints</a></li>
  <li><a href="#why-this-matters" id="toc-why-this-matters" class="nav-link" data-scroll-target="#why-this-matters">Why This Matters</a></li>
  </ul></li>
  <li><a href="#going-further-paid-llm-options" id="toc-going-further-paid-llm-options" class="nav-link" data-scroll-target="#going-further-paid-llm-options">Going Further: Paid LLM Options</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/aayushmnit/aayushmnit.github.io/blob/main/posts/2026-01-31_ReadWithAI/ReadWithAI.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/aayushmnit/aayushmnit.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Using AI to Read Technical Research Papers</h1>
  <div class="quarto-categories">
    <div class="quarto-category">AI</div>
    <div class="quarto-category">Research Papers</div>
    <div class="quarto-category">Reading</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aayush Agrawal </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 31, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>A practical guide to using local or paid LLMs to understand dense technical papers at your own pace.</p>
</blockquote>
<section id="why-i-started-using-ai-to-read-research-papers" class="level1">
<h1>Why I Started Using AI to Read Research Papers</h1>
<p>I‚Äôll be honest: I used to dread reading research papers. The dense math, the notation-heavy proofs, the assumption that you already know three other papers to understand this one. As an ML engineer, I knew these papers held insights I could apply at work, but actually extracting that value felt like a slog.</p>
<p>My learning style doesn‚Äôt mesh well with traditional academic writing. I learn best through small examples and code I can run and tinker with. Show me a 3x3 matrix example before the general n√ón case. Let me see the algorithm work on toy data before throwing theorems at me.</p>
<p>For years, this created a barrier. Research papers felt like they were written for PhDs, not practitioners. You either had the advanced math background to parse them, or you waited months for someone to write a blog post explaining it in plain English.</p>
<p>That‚Äôs changed. With AI assistants (both local and cloud-based LLMs), I can now have a conversation with a paper. I can ask ‚Äúwhat does this symbol mean?‚Äù or ‚Äúshow me this concept with a simple Python example‚Äù and get an answer calibrated to my current understanding. The paper adapts to me, not the other way around.</p>
<p>This post walks through my workflow for using AI to read technical papers, so you can apply the same approach to level up your own learning.</p>
<p>By the end of this post, you‚Äôll be able to:</p>
<ul>
<li>Set up a local LLM (using Ollama) or connect to cloud APIs for paper reading</li>
<li>Convert PDFs to markdown that LLMs can actually process</li>
<li>Craft system prompts that turn an LLM into a patient tutor, not a lecture-bot</li>
<li>Build an interactive Q&amp;A workflow where <em>you</em> control the pace and depth</li>
<li>Apply this approach to papers, documentation, or any dense technical content</li>
</ul>
<figure align="center" class="figure">
<img src="./core_workflow.jpg" style="width:100%" class="figure-img">
<figcaption align="center">
Figure: Core Workflow. Credit: <a href="https://notebooklm.google.com/">NotebookLM</a>
</figcaption>
</figure>
</section>
<section id="prerequisites-setup" class="level1">
<h1>Prerequisites &amp; Setup</h1>
<p>Before we dive in, let‚Äôs get our environment ready. You‚Äôll need two things: a local LLM running on your machine, and a few Python libraries to glue everything together.</p>
<section id="installing-ollama" class="level2">
<h2 class="anchored" data-anchor-id="installing-ollama">Installing Ollama</h2>
<p>Ollama makes running LLMs locally dead simple. Head to <a href="https://ollama.com">ollama.com</a> and download the installer for your OS. On Mac, it‚Äôs a standard <code>.dmg</code> install. On Linux, a one-liner:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-fsSL</span> https://ollama.com/install.sh <span class="kw">|</span> <span class="fu">sh</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Once installed, verify it‚Äôs working:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ollama</span> <span class="at">--version</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="choosing-and-pulling-a-model" class="level2">
<h2 class="anchored" data-anchor-id="choosing-and-pulling-a-model">Choosing and Pulling a Model</h2>
<p>Browse the <a href="https://ollama.com/search">Ollama model library</a> to see what‚Äôs available. For reading papers with diagrams and equations, I recommend <a href="https://ollama.com/library/qwen3-vl:8b">qwen3-vl:8b</a>, a vision-language model that can handle both text and images. You can use other models based on your machine‚Äôs specifications.</p>
<p>Pull it with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ollama</span> pull qwen3-vl:8b</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This downloads the model weights (around 5GB). Grab a coffee.</p>
<p>To start serving:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="va">OLLAMA_CONTEXT_LENGTH</span><span class="op">=</span>64000 <span class="ex">ollama</span> serve</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Keep this terminal running. Ollama now exposes an OpenAI-compatible API at <code>localhost:11434</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Note: Default context length in Ollama is 4096 tokens which is too small for our usecase, so we bump it upto 64K.</p>
</div>
</div>
</div>
</section>
<section id="python-libraries" class="level2">
<h2 class="anchored" data-anchor-id="python-libraries">Python Libraries</h2>
<p>We need three packages:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Library</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/pymupdf/pymupdf4llm"><code>pymupdf4llm</code></a></td>
<td>Converts PDF pages to clean markdown that LLMs can parse</td>
</tr>
<tr class="even">
<td><a href="https://lisette.answer.ai/"><code>lisette</code></a></td>
<td>Lightweight wrapper on <a href="https://github.com/BerriAI/litellm"><code>litellm</code></a> that simplifies multi-turn conversations and provide a Unified API to talk to 100+ LLM providers (local or cloud) with one interface</td>
</tr>
</tbody>
</table>
<p>Install them:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install pymupdf4llm lisette</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>With Ollama running and these libraries installed, you‚Äôre ready to start chatting with papers.</p>
</section>
</section>
<section id="core-workflow-pdf-to-conversation" class="level1">
<h1>Core Workflow: PDF to Conversation</h1>
<p>The workflow has two parts: getting the paper into a format LLMs can work with, then setting up the conversation so the AI becomes a useful tutor rather than a generic chatbot.</p>
<section id="converting-pdf-to-markdown" class="level2">
<h2 class="anchored" data-anchor-id="converting-pdf-to-markdown">Converting PDF to Markdown</h2>
<p>First step is to convert a pdf into text. <a href="https://github.com/pymupdf/pymupdf4llm"><code>pymupdf4llm</code></a> handles this by extracting text while preserving structure. Here‚Äôs an example, reading this <a href="https://dl.acm.org/doi/epdf/10.1145/3269206.3272018">paper</a>:</p>
<div id="cell-18" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T22:49:54.486641Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T22:49:22.944716Z&quot;}}" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymupdf4llm</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert PDF to txt</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>paper_txt <span class="op">=</span> pymupdf4llm.to_markdown(<span class="st">"./paper/1_2018_DPP_YT.pdf"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the paper as Markdown</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"./paper/1_2018_DPP_YT.md"</span>, <span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    f.write(paper_txt)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Consider using the pymupdf_layout package for a greatly improved page layout analysis.</code></pre>
</div>
</div>
<p>Let‚Äôs see the first paragraph.</p>
<div id="cell-20" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:06:51.550597Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:06:51.547622Z&quot;}}" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(paper_txt[:<span class="dv">500</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Industry and Case Study Paper CIKM‚Äô18, October 22-26, 2018, Torino, Italy

# **Practical Diversified Recommendations on YouTube with** **Determinantal Point Processes**


Mark Wilhelm, Ajith Ramanathan, Alexander Bonomo, Sagar Jain, Ed H. Chi, Jennifer Gillenwater
Google Inc.
{wilhelm,ajith,bonomo,sagarj,edchi,jengi}@google.com



**ABSTRACT**


Many recommendation systems produce result sets with large numbers of highly similar items. Diversifying these results is often
accomplished with heuris</code></pre>
</div>
</div>
<p>That‚Äôs it. You now have clean markdown with headers, code blocks, and reasonable table formatting. For papers with complex layouts, the results aren‚Äôt perfect, but they‚Äôre good enough for an LLM to understand the content. If you want a more accurate PDF to markdown converter, you can also look at <a href="https://github.com/datalab-to/marker">Datalab Marker</a>.</p>
</section>
<section id="designing-your-system-prompt" class="level2">
<h2 class="anchored" data-anchor-id="designing-your-system-prompt">Designing Your System Prompt</h2>
<p>This is where the magic happens. A vanilla ‚Äúyou are a helpful assistant‚Äù prompt gives you Wikipedia-style explanations. A well-crafted system prompt gives you a patient tutor who meets you at your level.</p>
<p>Here‚Äôs the prompt which works well for paper-reading sessions:</p>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:44:19.824112Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:44:19.821052Z&quot;}}" data-execution_count="66">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>system_prompt <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ss">You are helping a someone understand an academic paper.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="ss">Here is the paper </span><span class="ch">\n</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;paper&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>paper_txt<span class="sc">}</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/paper&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="ss">CRITICAL RULES:</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="ss">1. NEVER explain everything at once. Take ONE small step, then STOP and wait.</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="ss">2. ALWAYS start by asking what the learner already knows about the topic.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="ss">3. After each explanation, ask a question to check understanding OR ask what they want to explore next.</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="ss">4. Keep responses SHORT (2-4 paragraphs max). End with a question.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="ss">5. Use concrete examples and analogies before math. </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="ss">6. Build foundations with code - Teach unfamiliar mathematical concepts through small numpy experiments rather than pure theory. Let the learner run code and observe patterns.</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="ss">7. If they ask "explain X", first ask what parts of X they already understand.</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="ss">8. Use string format like this for formula display `L_ij = q_i √ó q_j √ó exp(-Œ± √ó D_ij^Œ≥)`.</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="ss">TEACHING FLOW:</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- Assess background ‚Üí Build intuition with examples ‚Üí Connect to math ‚Üí Let learner guide direction</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="ss">BAD (don't do this):</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="ss">"Here's everything about DPPs: [wall of text with all equations]"</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>The Teaching Prompt Deep-Dive</strong></p>
<p>The prompt design isn‚Äôt arbitrary. Each rule targets a specific failure mode I‚Äôve seen when using LLMs for learning:</p>
<ol type="1">
<li><p><strong>The paper lives in the system prompt.</strong> This keeps the full context available for every question you ask. You don‚Äôt need to re-paste sections or remind the AI what paper you‚Äôre discussing.</p></li>
<li><p><strong>‚ÄúIntuition before math‚Äù matches how practitioners learn.</strong> Most of us grasp concepts faster through examples and analogies than through theorem statements. If your learning style differs, swap in your own preferences here.</p></li>
<li><p><strong>‚ÄúTiny example first‚Äù counteracts the LLM‚Äôs default behavior.</strong> Without this, models tend toward abstract, general explanations. Forcing concrete examples (a 3x3 matrix, a toy dataset) makes concepts stick.</p></li>
<li><p><strong>‚ÄúCheck if I want to go deeper‚Äù prevents walls of text.</strong> LLMs love to explain everything at once. This rule puts you in control of pacing. You decide when to zoom in on details vs.&nbsp;move to the next topic.</p></li>
<li><p><strong>The ‚ÄúBAD‚Äù example shows what to avoid.</strong> Negative examples help the model understand boundaries. Without it, you‚Äôll get comprehensive but overwhelming responses.</p></li>
</ol>
<p><strong>Putting It Together:</strong> With these two pieces, you‚Äôre ready to start a conversation. The next section shows how to wire this up with lisette for a smooth multi-turn chat experience.</p>
</section>
</section>
<section id="wiring-up-the-conversation-with-lisette" class="level1">
<h1>Wiring Up the Conversation with Lisette</h1>
<p><a href="https://lisette.answer.ai/"><code>lisette</code></a> handles the boilerplate of multi-turn conversations: tracking message history, formatting requests for different LLM providers, and managing context windows. Here‚Äôs the minimal setup:</p>
<div id="cell-29" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:46:39.817331Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:46:39.813989Z&quot;}}" data-execution_count="71">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lisette <span class="im">import</span> Chat, contents</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML, Markdown, display</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>chat <span class="op">=</span> Chat(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span><span class="st">"ollama/qwen3-vl:8b"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    sp<span class="op">=</span><span class="st">""</span> <span class="co"># Insert prompt here</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>That‚Äôs it. The <code>model</code> string follows litellm‚Äôs <a href="https://docs.litellm.ai/docs/#basic-usage">provider/model convention</a>. For Ollama, prefix with <code>ollama/</code>. For cloud providers, you‚Äôd use <code>anthropic/claude-sonnet-4-20250514</code> or <code>openai/gpt-4o</code>.</p>
<p>To send a message and get a response:</p>
<div id="cell-31" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:46:49.184706Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:46:45.577198Z&quot;}}" data-execution_count="72">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>chat(<span class="st">"Hi! I am Aayush"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="72">
<p>Hello Aayush! üòä How can I assist you today? Let me know if you have any questions or need help with anything!</p>
<details>
<ul>
<li>id: <code>chatcmpl-9accb778-d9f9-4be5-8559-fb7d54b30a9f</code></li>
<li>model: <code>ollama/qwen3-vl:8b</code></li>
<li>finish_reason: <code>stop</code></li>
<li>usage: <code>Usage(completion_tokens=240, prompt_tokens=21, total_tokens=261, completion_tokens_details=None, prompt_tokens_details=None)</code></li>
</ul>
</details>
</div>
</div>
<p>As we can see above, it‚Äôs as easy to start a conversation with a <code>ollama</code> running in your local machine. <code>Chat</code> class is designed to be persistent which means it remembers the previous conversations.</p>
<div id="cell-33" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:48:51.022982Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:48:46.741893Z&quot;}}" data-execution_count="73">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chat(<span class="st">"What's my name?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="73">
<p>Your name is <strong>Aayush</strong>! üòä I remember you mentioned it in your first message. Is there anything else you‚Äôd like to share or ask?</p>
<details>
<ul>
<li>id: <code>chatcmpl-d8858647-054a-44af-a9cd-6640b248de24</code></li>
<li>model: <code>ollama/qwen3-vl:8b</code></li>
<li>finish_reason: <code>stop</code></li>
<li>usage: <code>Usage(completion_tokens=323, prompt_tokens=60, total_tokens=383, completion_tokens_details=None, prompt_tokens_details=None)</code></li>
</ul>
</details>
</div>
</div>
<p>As you can see model remembers my name from the previous conversation. Each call to <code>chat()</code> appends your message and the AI‚Äôs response to the conversation history. The next time you call it, the model sees the full exchange so far. Let‚Äôs see current history:</p>
<div id="cell-35" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:49:22.421554Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:49:22.417041Z&quot;}}" data-execution_count="74">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>chat.hist</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>[{'role': 'user', 'content': 'Hi! I am Aayush'},
 Message(content='Hello Aayush! üòä How can I assist you today? Let me know if you have any questions or need help with anything!', role='assistant', tool_calls=None, function_call=None, provider_specific_fields=None),
 {'role': 'user', 'content': "What's my name?"},
 Message(content="Your name is **Aayush**! üòä I remember you mentioned it in your first message. Is there anything else you'd like to share or ask?", role='assistant', tool_calls=None, function_call=None, provider_specific_fields=None)]</code></pre>
</div>
</div>
<section id="live-example-reading-a-dpp-paper" class="level2">
<h2 class="anchored" data-anchor-id="live-example-reading-a-dpp-paper">Live Example: Reading a DPP Paper</h2>
<p>Here‚Äôs a real exchange from when I was working through a paper on Determinantal Point Processes. For ease of reading in the blog post, lets create a class which can render the AI output in a terminal style for easy reading.</p>
<div id="cell-38" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:55:42.337179Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:55:42.333459Z&quot;}}" data-execution_count="79">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ask(chat, question, <span class="op">**</span>kwargs):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> chat(question, <span class="op">**</span>kwargs)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> contents(r).content</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    display(HTML(<span class="ss">f"""</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div style="background-color: #1e1e1e; color: #00ff00; padding: 12px; </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="ss">                border-radius: 5px; font-family: monospace; white-space: pre-wrap;"&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;span style="color: #00aaff;"&gt;You:&lt;/span&gt; </span><span class="sc">{</span>question<span class="sc">}</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;span style="color: #ffcc00;"&gt;Tutor:&lt;/span&gt; </span><span class="sc">{</span>text<span class="sc">}</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span>))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>chat <span class="op">=</span> Chat(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span><span class="st">"ollama/qwen3-vl:8b"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    sp<span class="op">=</span>system_prompt</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This time we are actually passing the prompt we created in previous section with paper text and our instructions.</p>
</div>
</div>
</div>
<div id="cell-40" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:55:51.897622Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:55:43.709641Z&quot;}}" data-execution_count="80">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="st">I want to learn about this paper. Help me.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>ask(chat, q, think<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">

    <div style="background-color: #1e1e1e; color: #00ff00; padding: 12px; 
                border-radius: 5px; font-family: monospace; white-space: pre-wrap;">
<span style="color: #00aaff;">You:</span> 
I want to learn about this paper. Help me.


<span style="color: #ffcc00;">Tutor:</span> Let's start with a simple question: What do you already know about recommendation systems or diversification? Are you familiar with YouTube's recommendation algorithm? Or maybe you've heard of techniques like collaborative filtering or matrix factorization?

I'm excited about this paper because it tackles a real problem we face on YouTube: when users scroll through recommendations, they often see similar videos in a row, which can cause them to abandon the feed. The authors used a statistical model called Determinantal Point Processes (DPPs) to diversify recommendations while still respecting user preferences.

What aspects of this paper interest you most? Are you more curious about how DPPs work conceptually, how they were implemented at scale, or the specific results YouTube saw? I can tailor my explanation to what you'd like to explore first.
    </div>
    
</div>
</div>
<div id="cell-41" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:57:04.961755Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:56:50.293867Z&quot;}}" data-execution_count="81">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="st">I know about recommendation systems and work on a large recommender system which serves video content.</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="st">I am familiar with recommendation algorithms. I am interested in understanding how DPP works.</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>ask(chat, q, think<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">

    <div style="background-color: #1e1e1e; color: #00ff00; padding: 12px; 
                border-radius: 5px; font-family: monospace; white-space: pre-wrap;">
<span style="color: #00aaff;">You:</span> 
I know about recommendation systems and work on a large recommender system which serves video content.
I am familiar with recommendation algorithms. I am interested in understanding how DPP works.


<span style="color: #ffcc00;">Tutor:</span> The core idea of DPPs is modeling **repulsion between items** in a recommendation list. Unlike traditional pointwise scoring (e.g., sorting by individual video quality scores), DPPs consider *how items interact* when presented together. For example, if two basketball videos are shown consecutively, the DPP model would reduce the probability of both being selected because they're redundant. 

In your video recommender system, this translates to: Instead of just selecting the "highest quality" videos, DPPs automatically suppress items that would decrease overall user engagement when placed together. The magic happens in the **determinant calculation**: when you take the determinant of a submatrix from the kernel matrix `L`, it measures both the individual quality of items (via diagonal entries) and their mutual diversity (via off-diagonal entries). A large determinant means you've selected a diverse set with high overall utility.

Would you like me to walk through a simple Python example using NumPy to demonstrate how the determinant of a 2x2 kernel matrix captures both quality and diversity? Or would you prefer to first understand why this approach is better than heuristic methods like "sliding window" diversity?
    </div>
    
</div>
</div>
<div id="cell-42" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-01-31T23:58:41.928606Z&quot;,&quot;start_time&quot;:&quot;2026-01-31T23:58:09.737823Z&quot;}}" data-execution_count="82">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="st">Yes I don't understand what determinant are, can you help me understand the basic intuition and use code examples?</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">I am fairly familiar with numpy.</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ask(chat, q)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">

    <div style="background-color: #1e1e1e; color: #00ff00; padding: 12px; 
                border-radius: 5px; font-family: monospace; white-space: pre-wrap;">
<span style="color: #00aaff;">You:</span> 
Yes I don't understand what determinant are, can you help me understand the basic intuition and use code examples?
I am fairly familiar with numpy.


<span style="color: #ffcc00;">Tutor:</span> Let's visualize this with a simple NumPy example. Determinants measure how "spread out" a matrix is - think of it as the volume of the parallelogram formed by the matrix's columns. For DPPs, this volume represents both item quality and diversity:

```python
import numpy as np

# Create two items with different qualities
q1 = 5.0  # High-quality video
q2 = 1.0  # Low-quality video

# Case 1: Similar items (D=0.5)
L_similar = np.array([
    [q1**2, 0.5 * q1 * q2 * np.exp(-0.5**2 / 2)],
    [0.5 * q1 * q2 * np.exp(-0.5**2 / 2), q2**2]
])
print("Determinant for similar items:", np.linalg.det(L_similar))

# Case 2: Dissimilar items (D=2.0)
L_dissimilar = np.array([
    [q1**2, 0.5 * q1 * q2 * np.exp(-2.0**2 / 2)],
    [0.5 * q1 * q2 * np.exp(-2.0**2 / 2), q2**2]
])
print("Determinant for dissimilar items:", np.linalg.det(L_dissimilar))
```

What you'll see:
- When items are similar (D=0.5), the determinant is small (‚âà18.75)
- When items are dissimilar (D=2.0), the determinant is larger (‚âà24.99)

Why? The determinant combines:
1. **Quality**: Diagonal terms (q1¬≤ and q2¬≤)
2. **Diversity**: Off-diagonal terms (which decrease as items become more dissimilar)

This creates a natural trade-off: adding a high-quality but similar item reduces the determinant (bad), while adding a high-quality dissimilar item increases it (good).

Would you like me to:
1. Show the actual numbers from the paper's experiments?
2. Explain how this connects to YouTube's specific implementation?
3. Or dive deeper into why determinants work for this problem?
    </div>
    
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The rendering from <code>Chat</code> class is markdown style, which is more readable. The above examples are wrapped for easy separation b/w blog text and code output.</p>
</div>
</div>
</div>
</section>
</section>
<section id="managing-chat-history-checkpoints-and-context-control" class="level1">
<h1>Managing Chat History: Checkpoints and Context Control</h1>
<p>One advantage of this approach over general chat interfaces is that you have full access to the conversation history. This matters when sessions get long or when the AI goes down a wrong path and you want to rewind.</p>
<section id="accessing-the-history" class="level2">
<h2 class="anchored" data-anchor-id="accessing-the-history">Accessing the History</h2>
<p>The <code>Chat</code> object stores messages in a list you can inspect and modify:</p>
<div id="cell-48" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-02-01T00:01:06.578213Z&quot;,&quot;start_time&quot;:&quot;2026-02-01T00:01:06.574404Z&quot;}}" data-execution_count="86">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See the current conversation</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(chat.hist)  <span class="co"># Returns list of message dicts</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many turns you've had</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(chat.hist))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[{'role': 'user', 'content': '\nI want to learn about this paper. Help me.\n'}, Message(content="Let's start with a simple question: What do you already know about recommendation systems or diversification? Are you familiar with YouTube's recommendation algorithm? Or maybe you've heard of techniques like collaborative filtering or matrix factorization?\n\nI'm excited about this paper because it tackles a real problem we face on YouTube: when users scroll through recommendations, they often see similar videos in a row, which can cause them to abandon the feed. The authors used a statistical model called Determinantal Point Processes (DPPs) to diversify recommendations while still respecting user preferences.\n\nWhat aspects of this paper interest you most? Are you more curious about how DPPs work conceptually, how they were implemented at scale, or the specific results YouTube saw? I can tailor my explanation to what you'd like to explore first.", role='assistant', tool_calls=None, function_call=None, provider_specific_fields=None), {'role': 'user', 'content': '\nI know about recommendation systems and work on a large recommender system which serves video content.\nI am familiar with recommendation algorithms. I am interested in understanding how DPP works.\n'}, Message(content='The core idea of DPPs is modeling **repulsion between items** in a recommendation list. Unlike traditional pointwise scoring (e.g., sorting by individual video quality scores), DPPs consider *how items interact* when presented together. For example, if two basketball videos are shown consecutively, the DPP model would reduce the probability of both being selected because they\'re redundant. \n\nIn your video recommender system, this translates to: Instead of just selecting the "highest quality" videos, DPPs automatically suppress items that would decrease overall user engagement when placed together. The magic happens in the **determinant calculation**: when you take the determinant of a submatrix from the kernel matrix `L`, it measures both the individual quality of items (via diagonal entries) and their mutual diversity (via off-diagonal entries). A large determinant means you\'ve selected a diverse set with high overall utility.\n\nWould you like me to walk through a simple Python example using NumPy to demonstrate how the determinant of a 2x2 kernel matrix captures both quality and diversity? Or would you prefer to first understand why this approach is better than heuristic methods like "sliding window" diversity?', role='assistant', tool_calls=None, function_call=None, provider_specific_fields=None), {'role': 'user', 'content': "\nYes I don't understand what determinant are, can you help me understand the basic intuition and use code examples?\nI am fairly familiar with numpy.\n"}, Message(content='Let\'s visualize this with a simple NumPy example. Determinants measure how "spread out" a matrix is - think of it as the volume of the parallelogram formed by the matrix\'s columns. For DPPs, this volume represents both item quality and diversity:\n\n```python\nimport numpy as np\n\n# Create two items with different qualities\nq1 = 5.0  # High-quality video\nq2 = 1.0  # Low-quality video\n\n# Case 1: Similar items (D=0.5)\nL_similar = np.array([\n    [q1**2, 0.5 * q1 * q2 * np.exp(-0.5**2 / 2)],\n    [0.5 * q1 * q2 * np.exp(-0.5**2 / 2), q2**2]\n])\nprint("Determinant for similar items:", np.linalg.det(L_similar))\n\n# Case 2: Dissimilar items (D=2.0)\nL_dissimilar = np.array([\n    [q1**2, 0.5 * q1 * q2 * np.exp(-2.0**2 / 2)],\n    [0.5 * q1 * q2 * np.exp(-2.0**2 / 2), q2**2]\n])\nprint("Determinant for dissimilar items:", np.linalg.det(L_dissimilar))\n```\n\nWhat you\'ll see:\n- When items are similar (D=0.5), the determinant is small (‚âà18.75)\n- When items are dissimilar (D=2.0), the determinant is larger (‚âà24.99)\n\nWhy? The determinant combines:\n1. **Quality**: Diagonal terms (q1¬≤ and q2¬≤)\n2. **Diversity**: Off-diagonal terms (which decrease as items become more dissimilar)\n\nThis creates a natural trade-off: adding a high-quality but similar item reduces the determinant (bad), while adding a high-quality dissimilar item increases it (good).\n\nWould you like me to:\n1. Show the actual numbers from the paper\'s experiments?\n2. Explain how this connects to YouTube\'s specific implementation?\n3. Or dive deeper into why determinants work for this problem?', role='assistant', tool_calls=None, function_call=None, provider_specific_fields=None)]
6</code></pre>
</div>
</div>
</section>
<section id="creating-checkpoints" class="level2">
<h2 class="anchored" data-anchor-id="creating-checkpoints">Creating Checkpoints</h2>
<p>Before exploring a tangent, save your current state:</p>
<div id="cell-51" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-02-01T00:02:38.789367Z&quot;,&quot;start_time&quot;:&quot;2026-02-01T00:02:30.877591Z&quot;}}" data-execution_count="88">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save checkpoint before a risky question</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>checkpoint <span class="op">=</span> <span class="bu">len</span>(chat.hist)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ask something that might derail the conversation</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ask(chat, <span class="st">"Actually, can you explain all the math in one go?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">

    <div style="background-color: #1e1e1e; color: #00ff00; padding: 12px; 
                border-radius: 5px; font-family: monospace; white-space: pre-wrap;">
<span style="color: #00aaff;">You:</span> Actually, can you explain all the math in one go?

<span style="color: #ffcc00;">Tutor:</span> I understand you want a comprehensive explanation, but I need to be honest: explaining all the math at once would overwhelm you. The paper contains several key mathematical concepts that build on each other, including:

1. **Determinantal Point Processes (DPPs)** - Probabilistic models that capture repulsion between items
2. **Kernel matrices** - The `L` matrix that encodes both item quality and diversity
3. **Determinant calculation** - The core operation that measures set utility
4. **Approximate inference** - How they compute DPPs at scale

Let's take one concept at a time. Would you like me to:
1. Explain the kernel matrix `L` with a concrete example?
2. Show how the determinant calculation works for small sets?
3. Walk through the training procedure for the DPP parameters?

I can provide a focused explanation on whichever part interests you most. What would you like to explore first?
    </div>
    
</div>
</div>
<div id="cell-52" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-02-01T00:04:26.417982Z&quot;,&quot;start_time&quot;:&quot;2026-02-01T00:04:26.413977Z&quot;}}" data-execution_count="101">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># That response was overwhelming. Rewind.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>chat.hist <span class="op">=</span> chat.hist[:checkpoint]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(chat.hist[<span class="bu">len</span>(chat.hist)<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Message(content='Let\'s visualize this with a simple NumPy example. Determinants measure how "spread out" a matrix is - think of it as the volume of the parallelogram formed by the matrix\'s columns. For DPPs, this volume represents both item quality and diversity:\n\n```python\nimport numpy as np\n\n# Create two items with different qualities\nq1 = 5.0  # High-quality video\nq2 = 1.0  # Low-quality video\n\n# Case 1: Similar items (D=0.5)\nL_similar = np.array([\n    [q1**2, 0.5 * q1 * q2 * np.exp(-0.5**2 / 2)],\n    [0.5 * q1 * q2 * np.exp(-0.5**2 / 2), q2**2]\n])\nprint("Determinant for similar items:", np.linalg.det(L_similar))\n\n# Case 2: Dissimilar items (D=2.0)\nL_dissimilar = np.array([\n    [q1**2, 0.5 * q1 * q2 * np.exp(-2.0**2 / 2)],\n    [0.5 * q1 * q2 * np.exp(-2.0**2 / 2), q2**2]\n])\nprint("Determinant for dissimilar items:", np.linalg.det(L_dissimilar))\n```\n\nWhat you\'ll see:\n- When items are similar (D=0.5), the determinant is small (‚âà18.75)\n- When items are dissimilar (D=2.0), the determinant is larger (‚âà24.99)\n\nWhy? The determinant combines:\n1. **Quality**: Diagonal terms (q1¬≤ and q2¬≤)\n2. **Diversity**: Off-diagonal terms (which decrease as items become more dissimilar)\n\nThis creates a natural trade-off: adding a high-quality but similar item reduces the determinant (bad), while adding a high-quality dissimilar item increases it (good).\n\nWould you like me to:\n1. Show the actual numbers from the paper\'s experiments?\n2. Explain how this connects to YouTube\'s specific implementation?\n3. Or dive deeper into why determinants work for this problem?', role='assistant', tool_calls=None, function_call=None, provider_specific_fields=None)</code></pre>
</div>
</div>
</section>
<section id="why-this-matters" class="level2">
<h2 class="anchored" data-anchor-id="why-this-matters">Why This Matters</h2>
<p>Two problems this solves:</p>
<ol type="1">
<li><p><strong>Context bloat.</strong> Long conversations eat up your context window. If you spent 10 turns on a section you now understand, trim those exchanges and reclaim tokens for the next topic.</p></li>
<li><p><strong>Context poisoning.</strong> If the AI misunderstands something and you correct it, the wrong explanation still sits in history, potentially confusing later responses. Removing it gives you a cleaner slate.</p></li>
</ol>
</section>
</section>
<section id="going-further-paid-llm-options" class="level1">
<h1>Going Further: Paid LLM Options</h1>
<p>Local models are great for privacy and cost, but sometimes you need more firepower. Longer papers, denser math, or multi-step reasoning tasks can benefit from larger models like Claude or GPT-4o.</p>
<p>The good news: lisette uses litellm under the hood, so switching providers is a one-line change.</p>
<p>For cloud providers, you‚Äôll need API keys. Set them as environment variables or use a <code>.env</code> file:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">ANTHROPIC_API_KEY</span><span class="op">=</span><span class="st">"your-key-here"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">OPENAI_API_KEY</span><span class="op">=</span><span class="st">"your-key-here"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="cell-58" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-02-01T00:14:15.591206Z&quot;,&quot;start_time&quot;:&quot;2026-02-01T00:14:15.587238Z&quot;}}" data-execution_count="122">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>load_dotenv()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Print first string of Anthropic key: </span><span class="sc">{</span>os<span class="sc">.</span>getenv(<span class="st">'ANTHROPIC_API_KEY'</span>)[:<span class="dv">15</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Print first string of Anthropic key: sk-ant-api03-JS</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;ExecuteTime&quot;,&quot;value&quot;:{&quot;end_time&quot;:&quot;2026-02-01T00:12:53.828713Z&quot;,&quot;start_time&quot;:&quot;2026-02-01T00:12:51.282858Z&quot;}}" data-execution_count="121">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Claude (Anthropic)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>chat <span class="op">=</span> Chat(model<span class="op">=</span><span class="st">"anthropic/claude-haiku-4-5"</span>, sp<span class="op">=</span>system_prompt)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ask(chat, <span class="st">"Help me understand the paper"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">

    <div style="background-color: #1e1e1e; color: #00ff00; padding: 12px; 
                border-radius: 5px; font-family: monospace; white-space: pre-wrap;">
<span style="color: #00aaff;">You:</span> Help me understand the paper

<span style="color: #ffcc00;">Tutor:</span> I'd love to help! This is a really interesting paper about improving YouTube recommendations.

Before I dive in, let me ask: **What's your background?** For example:
- Are you familiar with recommendation systems (like how Netflix suggests movies)?
- Do you know what machine learning models are?
- Have you seen probability/statistics before?

Also, **what part interests you most?** The paper covers several things:
1. The *problem* (why similar videos in a feed is bad)
2. The *solution* (using something called DPPs)
3. The *results* (how well it worked on YouTube)

What would you like to start with?
    </div>
    
</div>
</div>
<p>As you can see the workflow stays identical. Your system prompt, conversation history, and teaching flow all transfer across providers.</p>
</section>
<section id="key-takeaways" class="level1">
<h1>Key Takeaways</h1>
<p>Reading technical papers used to be a solitary grind. You either had the background to parse the notation, or you didn‚Äôt. AI changes this equation.</p>
<p>Here‚Äôs what I want you to walk away with:</p>
<ol type="1">
<li><p><strong>The barrier to technical content has dropped.</strong> The same workflow that worked for this paper works for textbooks, API documentation, dense blog posts, or any content where you need concepts explained at your level. The AI adapts to you.</p></li>
<li><p><strong>You control the pace and depth.</strong> Unlike courses or tutorials that assume a fixed audience, this approach lets you skip what you know and linger on what confuses you. Your learning path, not someone else‚Äôs curriculum.</p></li>
<li><p><strong>Local LLMs make this nearly free.</strong> Ollama plus a capable open model means you can read papers all day without API costs. You can try reading books, YT transcripts, brainstorming using same method. One tool, many uses.</p></li>
<li><p><strong>The system prompt is the lever.</strong> Generic prompts give generic results. The tutor prompt we built forces the AI into a teaching mode that actually helps. Steal it, tweak it, make it yours.</p></li>
<li><p><strong>Start with a paper you actually care about.</strong> Don‚Äôt practice on something boring. Pick a paper relevant to your work or a concept you‚Äôve always wanted to understand. Motivation carries you through the setup friction.</p></li>
</ol>
<p>The tools exist. The cost is minimal. The only question is which paper you‚Äôll read first.</p>
<p>I hope you found this blog useful. If you have questions or want to share your own Claude Code patterns, find me on <a href="https://www.linkedin.com/in/aayushmnit/">LinkedIn</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/aayushmnit\.com\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/aayushmnit/aayushmnit.github.io/blob/main/posts/2026-01-31_ReadWithAI/ReadWithAI.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/aayushmnit/aayushmnit.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>